{% extends 'schedule_editor/menu.html' %}
{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1>Редактор расписания{% if group %} {{ group }}{% endif %}</h1>
            <div id="week" class="grid-container"></div>
            <div class="ui-widget">
                <label>Группа</label>
                <select id="comboboxGroup" class="comb">
                    <option value="">Выберите группу...</option>
                    {% for student_g in student_group_list %}
                    <option value="{{ student_g.id }}" {% if request.GET.group|first == student_g.id|stringformat:"d" %} selected{% endif %}>{{ student_g.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="ui-widget">
                <label>Преподаватель</label>
                <select id="comboboxTeacher" class="comb">
                    <option value="">Выберите преподавателя...</option>
                    {% for teacher in teachers_list %}
                    <option value="{{ teacher.id }}" {% if request.GET.teacher|first == teacher.id|stringformat:"d" %} selected{% endif %}>{{ teacher }}</option>
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="ui-widget">
                <label>Аудитория</label>
                <select id="comboboxRoom" class="comb">
                    <option value="">Выберите аудиторию...</option>
                    {% for room in rooms_list %}
                    <option value="{{ room.id }}" {% if request.GET.room|first == room.id|stringformat:"d" %} selected{% endif %}>{{ room }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script>
    $(function() {
        var days = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
        var hours = ['h8', 'h9', 'h10', 'h11', 'h12', 'h13', 'h14', 'h15', 'h16', 'h17', 'h18', 'h19'];

        // Легенда по часам
        for (var h = 0; h < hours.length; h++) {
            var new_div = $('<div class="text-right"></div>');
            new_div.html('' + (8 + h) + ':00');
            new_div.addClass(hours[h]);
            new_div.addClass('legend-left');
            $('#week').append(new_div);
        }

        // Легенда по дням
        for (var d = 0; d < days.length; d++) {
            var new_div = $('<div class="text-center"></div>');
            new_div.html(days[d]);
            new_div.addClass('legend-top');
            new_div.addClass(days[d]);
            $('#week').append(new_div);
        }

        // Рисуем сетку часов
        for (var h = 0; h < hours.length; h++) {
            for (var d = 0; d < days.length; d++) {
                var new_hour = $('<div class="border">&nbsp;</div>');
                new_hour.addClass(hours[h]);
                new_hour.addClass(days[d]);
                $('#week').append(new_hour);
            }
        }
    });

    $("select").change(function(){
        var $select = $(this);
        if ($select.attr('id') == "comboboxGroup")
            window.location.href = "?group=" + $select.val();
        if ($select.attr('id') == "comboboxTeacher")
            window.location.href = "?teacher=" + $select.val();
        if ($select.attr('id') == "comboboxRoom")
            window.location.href = "?room=" + $select.val();
    });
</script>
{% endblock %}